

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>anduryl.ui.results &mdash; Anduryl 1.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Anduryl
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code.html">Code documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Anduryl</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>anduryl.ui.results</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for anduryl.ui.results</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">cm</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="k">import</span> <span class="p">(</span><span class="n">FigureCanvasQTAgg</span><span class="p">,</span>
                                                <span class="n">NavigationToolbar2QT</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="k">import</span> <span class="n">Figure</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="k">import</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span>

<span class="kn">from</span> <span class="nn">anduryl.ui</span> <span class="k">import</span> <span class="n">widgets</span>
<span class="kn">from</span> <span class="nn">anduryl.ui.dialogs</span> <span class="k">import</span> <span class="n">NotificationDialog</span>
<span class="kn">from</span> <span class="nn">anduryl.ui.models</span> <span class="k">import</span> <span class="n">ArrayModel</span><span class="p">,</span> <span class="n">ListsModel</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">combinations</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">factorial</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;medium&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.handletextpad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.labelspacing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>

<div class="viewcode-block" id="ResultsWidget"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ResultsWidget">[docs]</a><span class="k">class</span> <span class="nc">ResultsWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Widget that contains all resultoverview in seperate tabs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mainwindow</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mainwindow : mainwindow class</span>
<span class="sd">            Main project widget</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ResultsWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span> <span class="o">=</span> <span class="n">mainwindow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">mainwindow</span><span class="o">.</span><span class="n">project</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTabWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">setTabsClosable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">tabCloseRequested</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close_results</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dm_ids</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">label</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Results&#39;</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QLabel {border: 1px solid &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">bordercolor</span><span class="o">+</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">VLayout</span><span class="p">([</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="p">]))</span>

<div class="viewcode-block" id="ResultsWidget.add_results"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ResultsWidget.add_results">[docs]</a>    <span class="k">def</span> <span class="nf">add_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add results in an Resultsoverview to the tabs. The specific</span>
<span class="sd">        results are derived from the settings, and passed to the</span>
<span class="sd">        overview</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        settings : dictionary</span>
<span class="sd">            Calculation setting</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get results to create overview</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span>
        <span class="n">resultsoverview</span> <span class="o">=</span> <span class="n">ResultOverview</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>

        <span class="c1"># Add to tabs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">resultsoverview</span><span class="p">,</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dm_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

        <span class="c1"># Add to export menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">add_export_actions</span><span class="p">(</span><span class="n">resultsoverview</span><span class="p">)</span></div>

<div class="viewcode-block" id="ResultsWidget.close_results"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ResultsWidget.close_results">[docs]</a>    <span class="k">def</span> <span class="nf">close_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">expert</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes results from the widget. Results can be removed</span>
<span class="sd">        by index or by expert id. If the results are removed by</span>
<span class="sd">        index, the results are also removed from the expert widget.</span>
<span class="sd">        The function is thus used in slightly different ways.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : int, optional</span>
<span class="sd">            Index of results to remove, by default None</span>
<span class="sd">        expert : str, optional</span>
<span class="sd">            Id of expert (decision maker) to remove, by default None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># When the function is called by expert id, find the index</span>
        <span class="k">if</span> <span class="n">expert</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dm_ids</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">expert</span><span class="p">)</span>
            
        <span class="c1"># Get current widget</span>
        <span class="n">currentQWidget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># Delete widget</span>
        <span class="n">currentQWidget</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>
        <span class="c1"># Close tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">removeTab</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">currentQWidget</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># Delete DM</span>
        <span class="n">dm_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dm_ids</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">dm_ids</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="c1"># If the function is called by index, and thus expert is None, remove also from table</span>
        <span class="c1"># If called by expert, the call comes from the table widget, and so removing is not needed</span>
        <span class="k">if</span> <span class="n">expert</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Remove from experts</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">expertswidget</span><span class="o">.</span><span class="n">remove_expert</span><span class="p">(</span><span class="n">dm_id</span><span class="p">)</span>

        <span class="c1"># Remove from export menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">remove_export_actions</span><span class="p">(</span><span class="n">dm_id</span><span class="p">)</span>

        <span class="c1"># Collapse results if last is removed</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dm_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">rightsplitter</span><span class="o">.</span><span class="n">setSizes</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="ResultOverview"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ResultOverview">[docs]</a><span class="k">class</span> <span class="nc">ResultOverview</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QScrollArea</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Widget with results for a decision maker.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mainwindow</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">settings</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copy results from current project. Note that the results are copied</span>
<span class="sd">        and not refered to, since we want to &#39;freeze&#39; the current project in</span>
<span class="sd">        these results. </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ResultOverview</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span> <span class="o">=</span> <span class="n">mainwindow</span>

        <span class="c1"># Copy project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">settings</span>
        
        <span class="c1"># Calculate lower bounds once. Since these results are frozen the bounds won&#39;t change</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">lower_k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">upper_k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">(</span><span class="n">overshoot</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;overshoot&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">robustness_model</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_ui</span><span class="p">()</span>


<div class="viewcode-block" id="ResultOverview.init_ui"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ResultOverview.init_ui">[docs]</a>    <span class="k">def</span> <span class="nf">init_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set up the result overview in the user interface.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">NoFrame</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">setWidgetResizable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">hlayout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hlayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
        <span class="n">hlayout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">hlayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>

        <span class="n">label_layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGridLayout</span><span class="p">()</span>
        <span class="n">label_layout</span><span class="o">.</span><span class="n">setHorizontalSpacing</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

        <span class="c1"># Add results settings</span>
        <span class="n">label_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Weights: </span><span class="si">{self.settings[&#39;weight&#39;]}</span><span class="s2">&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">label_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Optimisation: {&#39;yes&#39; if self.settings[&#39;optimisation&#39;] else &#39;no&#39;}&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">label_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Intrinsic range: </span><span class="si">{self.settings[&#39;overshoot&#39;]}</span><span class="s2">&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">label_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Significance level: </span><span class="si">{self.results.alpha_opt:.4g}</span><span class="s2">&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">label_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Calibration power: </span><span class="si">{self.settings[&#39;calpower&#39;]}</span><span class="s2">&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_items_button</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Plot items&#39;</span><span class="p">,</span> <span class="n">clicked</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_items</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_items_button</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">SimpleGroupBox</span><span class="p">([</span><span class="n">label_layout</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_items_button</span><span class="p">],</span> <span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="s1">&#39;Decision maker characteristics&#39;</span><span class="p">))</span>

        <span class="c1"># Create the table view</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableView</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scores_table</span> <span class="o">=</span> <span class="n">table</span>
        <span class="n">table</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setShowGrid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setAlternatingRowColors</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="c1"># Get weights</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">]:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;equal&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">actual_experts</span><span class="p">)</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;user&#39;</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">user_weights</span><span class="p">)</span>
            <span class="n">idx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">get_idx</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">weights</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">user_weights</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">user_weights</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="c1"># Correct for alpha threshold</span>
        <span class="n">weights</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">calibration</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">alpha_opt</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># Set DM to zero</span>
        <span class="n">dm_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">get_idx</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span><span class="p">)</span>
        <span class="n">weights</span><span class="p">[</span><span class="n">dm_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># Create and add model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scores_model</span> <span class="o">=</span> <span class="n">ListsModel</span><span class="p">(</span>
            <span class="n">lists</span><span class="o">=</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">calibration</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">info_real</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">info_total</span><span class="p">,</span>
                <span class="n">weights</span>                
            <span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Calibration&#39;</span><span class="p">,</span> <span class="s1">&#39;Info score real.&#39;</span><span class="p">,</span> <span class="s1">&#39;Info score total&#39;</span><span class="p">,</span> <span class="s1">&#39;Weight&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scores_model</span><span class="p">)</span>

        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">get_table_size</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scores_model</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setVerticalScrollBarPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ScrollBarAlwaysOff</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setHorizontalScrollBarPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ScrollBarAlwaysOff</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show_item_weights_button</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Info score per item&#39;</span><span class="p">,</span> <span class="n">clicked</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_items</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_item_weights_button</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">SimpleGroupBox</span><span class="p">([</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_item_weights_button</span><span class="p">],</span> <span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="s1">&#39;Expert and DM weights&#39;</span><span class="p">))</span>
        
        <span class="c1"># Add a table for the item robustness</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">item_robustness</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">expert_robustness</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">robustness_tables</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTabWidget</span><span class="p">()</span>
        
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">item_robustness</span><span class="p">:</span>
                <span class="n">seedidx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">get_idx</span><span class="p">(</span><span class="s1">&#39;seed&#39;</span><span class="p">)</span>
                <span class="n">seeditems</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span> <span class="k">if</span> <span class="n">seedidx</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">item_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">item_robustness</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="n">itemid</span><span class="p">]</span> <span class="k">if</span> <span class="n">itemid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[])]</span> <span class="k">for</span> <span class="n">itemid</span> <span class="ow">in</span> <span class="n">seeditems</span><span class="p">])</span>
                <span class="n">seeditems</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ui_add_robustness_table</span><span class="p">(</span><span class="s1">&#39;Items&#39;</span><span class="p">,</span> <span class="n">seeditems</span><span class="p">,</span> <span class="n">item_array</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">expert_robustness</span><span class="p">:</span>
                <span class="n">experts</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">get_exp</span><span class="p">(</span><span class="s1">&#39;actual&#39;</span><span class="p">)</span>
                <span class="n">expert_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">expert_robustness</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="n">exp</span><span class="p">]</span> <span class="k">if</span> <span class="n">exp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[])]</span> <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">experts</span><span class="p">])</span> 
                <span class="n">experts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ui_add_robustness_table</span><span class="p">(</span><span class="s1">&#39;Experts&#39;</span><span class="p">,</span> <span class="n">experts</span><span class="p">,</span> <span class="n">expert_array</span><span class="p">)</span>

            <span class="c1"># Plot layout</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_excluded_button</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Plot multiple exluded items&#39;</span><span class="p">,</span> <span class="n">clicked</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_excluded_items</span><span class="p">)</span>
            <span class="n">button_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HLayout</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_excluded_button</span><span class="p">])</span>
            <span class="n">button_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">SimpleGroupBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">robustness_tables</span><span class="p">,</span> <span class="n">button_layout</span><span class="p">],</span> <span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="s1">&#39;Robustness&#39;</span><span class="p">))</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span></div>

<div class="viewcode-block" id="ResultOverview.ui_add_robustness_table"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ResultOverview.ui_add_robustness_table">[docs]</a>    <span class="k">def</span> <span class="nf">ui_add_robustness_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a robustness table (experts or items) to the UI</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            Experts or Items</span>
<span class="sd">        index : list</span>
<span class="sd">            Index for each table row</span>
<span class="sd">        array : np.ndarray</span>
<span class="sd">            Numpy arra with values to show in table</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableView</span><span class="p">()</span>
        <span class="n">table</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setShowGrid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setAlternatingRowColors</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">robustness_model</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ArrayModel</span><span class="p">(</span>
            <span class="n">array</span><span class="o">=</span><span class="n">array</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Info score total&#39;</span><span class="p">,</span> <span class="s1">&#39;Info score real.&#39;</span><span class="p">,</span> <span class="s1">&#39;Calibration&#39;</span><span class="p">]],</span>
            <span class="n">coldim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">rowdim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">index_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Item ID&#39;</span><span class="p">],</span>
            <span class="n">index</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="n">table</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">robustness_model</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">NoFrame</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">robustness_tables</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">get_table_size</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">robustness_model</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setVerticalScrollBarPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ScrollBarAlwaysOff</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setHorizontalScrollBarPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ScrollBarAlwaysOff</span><span class="p">)</span></div>

<div class="viewcode-block" id="ResultOverview.plot_excluded_items"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ResultOverview.plot_excluded_items">[docs]</a>    <span class="k">def</span> <span class="nf">plot_excluded_items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens a dialog to plot robustness for excluding multiple items.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dialog</span> <span class="o">=</span> <span class="n">PlotExcludedDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="ResultOverview.show_items"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ResultOverview.show_items">[docs]</a>    <span class="k">def</span> <span class="nf">show_items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens a dialog to information scores per item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters_dialog</span> <span class="o">=</span> <span class="n">ItemWeightDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div>

<div class="viewcode-block" id="ResultOverview.plot_items"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ResultOverview.plot_items">[docs]</a>    <span class="k">def</span> <span class="nf">plot_items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens a dialog to plot the distributions for experts and decision makers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dialog</span> <span class="o">=</span> <span class="n">PlotDistributionsDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="LegendTable"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.LegendTable">[docs]</a><span class="k">class</span> <span class="nc">LegendTable</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This widget is the table besides the distributions plot.</span>
<span class="sd">    It functions as an interactive legend, in which different</span>
<span class="sd">    lines can be toggled on and of.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialog</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dialog : PlotDistributionsDialog</span>
<span class="sd">            The parent dialog window in which the distributions are plotted.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dialog</span> <span class="o">=</span> <span class="n">dialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">colors</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">construct_widget</span><span class="p">()</span>

<div class="viewcode-block" id="LegendTable.construct_widget"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.LegendTable.construct_widget">[docs]</a>    <span class="k">def</span> <span class="nf">construct_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs the widget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create legend table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setMinimumSectionSize</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setSectionResizeMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHeaderView</span><span class="o">.</span><span class="n">Stretch</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setSectionResizeMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHeaderView</span><span class="o">.</span><span class="n">Stretch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setSectionResizeMode</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHeaderView</span><span class="o">.</span><span class="n">Fixed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setHighlightSections</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Expert&#39;</span><span class="p">,</span> <span class="s1">&#39;Weight&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">setSelectionBehavior</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidget</span><span class="o">.</span><span class="n">SelectRows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidget</span><span class="o">.</span><span class="n">MultiSelection</span><span class="p">)</span>
        
        <span class="n">p</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="p">()</span>
        <span class="c1"># Both active and inactive should follow inactive layout</span>
        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Active</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Inactive</span><span class="p">]:</span>
            <span class="c1"># Switch background</span>
            <span class="n">p</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Highlight</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Inactive</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Highlight</span><span class="p">))</span>
            <span class="c1"># p.setColor(group, QtGui.QPalette.Base, p.color(QtGui.QPalette.Inactive, QtGui.QPalette.Base))</span>
            
            <span class="c1"># Set text colors</span>
            <span class="n">p</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">HighlightedText</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Inactive</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">HighlightedText</span><span class="p">))</span>            
            <span class="n">p</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Inactive</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Dark</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPalette</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">itemSelectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">.</span><span class="n">_set_data_visible</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setEditTriggers</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidget</span><span class="o">.</span><span class="n">NoEditTriggers</span><span class="p">)</span></div>

<div class="viewcode-block" id="LegendTable.set_rows"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.LegendTable.set_rows">[docs]</a>    <span class="k">def</span> <span class="nf">set_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fill in the legend with all the expert id&#39;s and weights</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">plotby</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">.</span><span class="n">plotby_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;expert&#39;</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">ids</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Expert&#39;</span><span class="p">,</span> <span class="s1">&#39;Weight&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>

        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="p">(</span><span class="n">nrows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">400</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">itemSelectionChanged</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{self.results.experts.weights[i]:.4g}</span><span class="s1">&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;expert&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
            
            <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">*</span> <span class="mi">255</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]]][:</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">()</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setBackground</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="o">*</span><span class="n">color</span><span class="p">[:</span><span class="mi">3</span><span class="p">]))</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">selectAll</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">itemSelectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">.</span><span class="n">_set_data_visible</span><span class="p">)</span></div></div>
        
<div class="viewcode-block" id="PlotExcludedDialog"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotExcludedDialog">[docs]</a><span class="k">class</span> <span class="nc">PlotExcludedDialog</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog that shows the sensiticity of excluding experts or items</span>
<span class="sd">    from the project on the information and calibration score. The</span>
<span class="sd">    spread is shown by a box plot for each number of excluded experts</span>
<span class="sd">    or items.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PlotExcludedDialog</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">settings</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">robustness_results</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Count number of combinations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxexclude</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;experts&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">actual_experts</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">get_idx</span><span class="p">(</span><span class="s1">&#39;seed&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span>
        <span class="p">}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ncombs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">def</span> <span class="nf">nCr</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">//</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">r</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;experts&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">]:</span>

            <span class="n">maxtyp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxexclude</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ncombs</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">([</span><span class="n">nCr</span><span class="p">(</span><span class="n">maxtyp</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxtyp</span><span class="p">)])</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">construct_widget</span><span class="p">()</span>


<div class="viewcode-block" id="PlotExcludedDialog.construct_widget"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotExcludedDialog.construct_widget">[docs]</a>    <span class="k">def</span> <span class="nf">construct_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs the widget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Robustness&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowCloseButtonHint</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>

        <span class="c1"># Create figure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Set background color</span>
        <span class="n">bgcolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backgroundRole</span><span class="p">())</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bgcolor</span><span class="p">)</span>
        <span class="c1"># self.figure.tight_layout()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span>
        
        <span class="c1"># Add canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvasQTAgg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="n">NavigationToolbar2QT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QProgressBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">180</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">setTextVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="c1"># # Create comboboxes for data selection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_expert</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QRadioButton</span><span class="p">(</span><span class="s1">&#39;Expert&#39;</span><span class="p">,</span> <span class="n">clicked</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_maximum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QRadioButton</span><span class="p">(</span><span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="n">clicked</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_maximum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_expert</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_items</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_items</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_items</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_n_combinations</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncombinations_label</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Combinations: 1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_maximum</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_button</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Calculate and plot&#39;</span><span class="p">,</span> <span class="n">clicked</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calculate</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cat_combobox</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Information score: Seed items&#39;</span><span class="p">,</span> <span class="s1">&#39;Information score: All items&#39;</span><span class="p">,</span> <span class="s1">&#39;Calibration score&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cat_combobox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cat_combobox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">)</span>
        
        <span class="n">rightlayout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VLayout</span><span class="p">([</span>
            <span class="n">widgets</span><span class="o">.</span><span class="n">SimpleGroupBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">button_expert</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_item</span><span class="p">],</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Type:&#39;</span><span class="p">),</span>
            <span class="n">widgets</span><span class="o">.</span><span class="n">SimpleGroupBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_items</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncombinations_label</span><span class="p">],</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of items:&#39;</span><span class="p">),</span>
            <span class="n">widgets</span><span class="o">.</span><span class="n">SimpleGroupBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">calculate_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="p">],</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Calculation:&#39;</span><span class="p">),</span>
            <span class="n">widgets</span><span class="o">.</span><span class="n">SimpleGroupBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">cat_combobox</span><span class="p">],</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Score:&#39;</span><span class="p">),</span>
        <span class="p">])</span>
        <span class="n">rightlayout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">splitter</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSplitter</span><span class="p">()</span>
        <span class="n">splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
        
        <span class="n">rightwidget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
        <span class="n">rightwidget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">rightlayout</span><span class="p">)</span>
        <span class="n">splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">rightwidget</span><span class="p">)</span>
        
        <span class="n">splitter</span><span class="o">.</span><span class="n">setStretchFactor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">splitter</span><span class="o">.</span><span class="n">setStretchFactor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">splitter</span><span class="p">)</span>

        <span class="c1"># Add close button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">HLine</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">button_layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>

        <span class="c1"># OK and Cancel buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Close&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>

        <span class="n">button_box</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">button_box</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">RejectRole</span><span class="p">)</span>
        <span class="n">button_box</span><span class="o">.</span><span class="n">accepted</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialog</span><span class="o">.</span><span class="n">accept</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button_box</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">button_layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotExcludedDialog.update_progressbar"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotExcludedDialog.update_progressbar">[docs]</a>    <span class="k">def</span> <span class="nf">update_progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the progressbar with one step, after each iteration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotExcludedDialog.get_n_combinations"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotExcludedDialog.get_n_combinations">[docs]</a>    <span class="k">def</span> <span class="nf">get_n_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the number of combinations for excluding the selected number of</span>
<span class="sd">        experts or items.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ncombs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncombs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_type</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_items</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncombinations_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Combinations: </span><span class="si">{ncombs}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">ncombs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="PlotExcludedDialog.calculate"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotExcludedDialog.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the robustness for all combinations of excluding experts. This</span>
<span class="sd">        method is called after the calculate button is pressed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclude_type</span> <span class="o">==</span> <span class="s1">&#39;experts&#39;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">calculate_expert_robustness</span>
            <span class="n">dct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">expert_robustness</span>
            <span class="n">min_exclude</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">dct</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">calculate_item_robustness</span>
            <span class="n">dct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">item_robustness</span>
            <span class="n">min_exclude</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">dct</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="c1"># Call function</span>
        <span class="k">if</span> <span class="n">min_exclude</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_items</span><span class="o">.</span><span class="n">value</span><span class="p">():</span>
            <span class="c1"># Calculate remaining number to calculate</span>
            <span class="n">done</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">min_exclude</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncombs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_type</span><span class="p">][</span><span class="n">min_exclude</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">remaining</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncombs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_type</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_items</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">done</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="n">remaining</span><span class="p">)</span>
            
            <span class="n">func</span><span class="p">(</span>
                <span class="n">min_exclude</span><span class="o">=</span><span class="n">min_exclude</span><span class="p">,</span>
                <span class="n">max_exclude</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_items</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                <span class="n">weight_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                <span class="n">overshoot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;overshoot&#39;</span><span class="p">],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span>
                <span class="n">calpower</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;calpower&#39;</span><span class="p">],</span>
                <span class="n">progress_func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">update_progressbar</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">maximum</span><span class="p">())</span>

        <span class="c1"># Order results</span>
        <span class="n">nbins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_items</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">robustness_results</span> <span class="o">=</span> <span class="p">{</span><span class="n">cat</span><span class="p">:</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbins</span><span class="o">+</span><span class="mi">1</span><span class="p">)}</span> <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">}</span>
        <span class="n">bincats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">robustness_results</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dct</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">nitems</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nitems</span> <span class="o">&lt;=</span> <span class="n">nbins</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cat</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">robustness_results</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="n">nitems</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="PlotExcludedDialog.plot"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotExcludedDialog.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the figure plot, called after calculation.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">maximum</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">nbins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_items</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">category</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cat_combobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">robustness_results</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">robustness_results</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbins</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">nbins</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Number of exluded items </span><span class="si">{self.exclude_type}</span><span class="s1"> [-]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="PlotExcludedDialog.check_maximum"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotExcludedDialog.check_maximum">[docs]</a>    <span class="k">def</span> <span class="nf">check_maximum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the maximum number of calculations and sets the progess bar accordingly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exclude_type</span> <span class="o">=</span> <span class="s1">&#39;experts&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_expert</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;items&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_items</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxexclude</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_type</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_n_combinations</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div></div>
        
<div class="viewcode-block" id="PlotDistributionsDialog"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog">[docs]</a><span class="k">class</span> <span class="nc">PlotDistributionsDialog</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog in which the assessments of all experts, the result</span>
<span class="sd">    decision maker and all items are visualized. For one item different types</span>
<span class="sd">    of plots can be chosen: CDF, Exceedance probability, PDF and the range.</span>
<span class="sd">    Per expert only the range can be shown, since the scales of each item</span>
<span class="sd">    varies.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PlotDistributionsDialog</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">=</span> <span class="s1">&#39;cdf&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">=</span> <span class="s1">&#39;item&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;viridis_r&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">exp</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">ids</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">exp</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">construct_widget</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_plot</span><span class="p">()</span>

<div class="viewcode-block" id="PlotDistributionsDialog.construct_widget"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.construct_widget">[docs]</a>    <span class="k">def</span> <span class="nf">construct_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs the widget.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Distributions &amp; range&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowCloseButtonHint</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>

        <span class="c1"># Create figure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Set background color</span>
        <span class="n">bgcolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backgroundRole</span><span class="p">())</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bgcolor</span><span class="p">)</span>
        <span class="c1"># self.figure.tight_layout()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span>
        
        <span class="c1"># Add canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvasQTAgg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="n">NavigationToolbar2QT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setWordWrap</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">font</span><span class="o">=</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">()</span>
        <span class="n">font</span><span class="o">.</span><span class="n">setBold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="n">LegendTable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># Create comboboxes for data selection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotby_cbox</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ComboboxInputLine</span><span class="p">(</span><span class="s1">&#39;Plot by:&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="s1">&#39;Expert&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotby_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ComboboxInputLine</span><span class="p">(</span><span class="s1">&#39;Select item:&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cbox</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ComboboxInputLine</span><span class="p">(</span><span class="s1">&#39;Select plot type:&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;CDF&#39;</span><span class="p">,</span> <span class="s1">&#39;Exc Prob&#39;</span><span class="p">,</span> <span class="s1">&#39;PDF&#39;</span><span class="p">,</span> <span class="s1">&#39;Range&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connect_signals</span><span class="p">()</span>

        <span class="c1"># Initialize plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_plot</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_plotby</span><span class="p">()</span>

        <span class="n">leftlayout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VLayout</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
        
        <span class="n">dataselection</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">SimpleGroupBox</span><span class="p">(</span>
            <span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">plotby_cbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="p">],</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Select data&#39;</span><span class="p">)</span>
        
        <span class="n">rightlayout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VLayout</span><span class="p">([</span><span class="n">dataselection</span><span class="p">,</span> <span class="n">widgets</span><span class="o">.</span><span class="n">SimpleGroupBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">],</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;Select item/expert&#39;</span><span class="p">)])</span>        
        <span class="n">rightlayout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="n">splitter</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSplitter</span><span class="p">()</span>
        <span class="n">leftwidget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
        <span class="n">leftwidget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">leftlayout</span><span class="p">)</span>
        <span class="n">splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">leftwidget</span><span class="p">)</span>
        
        <span class="n">rightwidget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
        <span class="n">rightwidget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">rightlayout</span><span class="p">)</span>
        <span class="n">splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">rightwidget</span><span class="p">)</span>
        
        <span class="n">splitter</span><span class="o">.</span><span class="n">setStretchFactor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">splitter</span><span class="o">.</span><span class="n">setStretchFactor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">splitter</span><span class="p">)</span>

        <span class="c1"># Add close button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">HLine</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">button_layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>

        <span class="c1"># OK and Cancel buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Close&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>

        <span class="n">button_box</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">button_box</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">RejectRole</span><span class="p">)</span>
        <span class="n">button_box</span><span class="o">.</span><span class="n">accepted</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialog</span><span class="o">.</span><span class="n">accept</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button_box</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">button_layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">900</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotDistributionsDialog.connect_signals"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.connect_signals">[docs]</a>    <span class="k">def</span> <span class="nf">connect_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Connects the signals (again). This function and &quot;disconnect_signals&quot; are</span>
<span class="sd">        used to be able to change the dialog settings without updating all the figures.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotby_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_plotby</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">init_plot</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="PlotDistributionsDialog.disconnect_signals"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.disconnect_signals">[docs]</a>    <span class="k">def</span> <span class="nf">disconnect_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Disconnects the signals (again). This function and &quot;connect_signals&quot; are</span>
<span class="sd">        used to be able to change the dialog settings without updating all the figures.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotby_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span></div>

<div class="viewcode-block" id="PlotDistributionsDialog.init_plot"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.init_plot">[docs]</a>    <span class="k">def</span> <span class="nf">init_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the expert or items plot. Called after constructing the widget</span>
<span class="sd">        or after experts or items are chosen.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;expert&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_expert_plot</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_item_plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="PlotDistributionsDialog.init_expert_plot"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.init_expert_plot">[docs]</a>    <span class="k">def</span> <span class="nf">init_expert_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to initiate expert plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Clear axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        
        <span class="c1"># Add lines for expert</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">ids</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>

        <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">]</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">markers</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">quantiles</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">markers</span><span class="p">[</span><span class="n">offset</span><span class="p">:</span><span class="o">-</span><span class="n">offset</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">quantile</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">selection</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="n">quantile</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">c</span><span class="o">=</span><span class="p">[],</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># An extra draw is necessary for plotting the markers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            
        <span class="c1"># Get first plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="PlotDistributionsDialog.init_item_plot"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.init_item_plot">[docs]</a>    <span class="k">def</span> <span class="nf">init_item_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to initiate item plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="c1"># Clear axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="c1"># Add line for realization (only once)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="s1">&#39;realization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

        <span class="c1"># Add lines for expert</span>
        <span class="k">for</span> <span class="n">expert</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">expert</span><span class="p">],</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">expert</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">==</span> <span class="s1">&#39;pdf&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability density&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">==</span> <span class="s1">&#39;cdf&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Non-exceedance probability&#39;</span><span class="p">)</span>

        <span class="c1"># For range plot, add also the markers</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">==</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">]</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">markers</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">quantiles</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">selection</span> <span class="o">=</span> <span class="n">markers</span><span class="p">[</span><span class="n">offset</span><span class="p">:</span><span class="o">-</span><span class="n">offset</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">quantile</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">selection</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="n">quantile</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">c</span><span class="o">=</span><span class="p">[],</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="c1"># An extra draw is necessary for plotting the markers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            
        <span class="c1"># Get first plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="PlotDistributionsDialog.update_plotby"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.update_plotby">[docs]</a>    <span class="k">def</span> <span class="nf">update_plotby</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the expert or items plot type. Called after constructing the widget</span>
<span class="sd">        or after a different plot type is chosen.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disconnect_signals</span><span class="p">()</span>
        
        <span class="c1"># Remove current items</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plottype_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;expert&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s1">&#39;Range&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s1">&#39;CDF&#39;</span><span class="p">,</span> <span class="s1">&#39;Exc Prob&#39;</span><span class="p">,</span> <span class="s1">&#39;PDF&#39;</span><span class="p">,</span> <span class="s1">&#39;Range&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotby</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_signals</span><span class="p">()</span>
        
        <span class="c1"># Update legend rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">set_rows</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="PlotDistributionsDialog.update_plot"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.update_plot">[docs]</a>    <span class="k">def</span> <span class="nf">update_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to update a plot after changes are made to the data selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;expert&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_expert_plot</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_item_plot</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotby</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotDistributionsDialog.update_expert_plot"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.update_expert_plot">[docs]</a>    <span class="k">def</span> <span class="nf">update_expert_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to update the expert plot after changes are made to the data selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get item data</span>
        <span class="n">assessments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_expert_data</span><span class="p">()</span>
        <span class="c1"># Set title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_title</span><span class="p">()</span>

        <span class="n">selected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">idx</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">selectedIndexes</span><span class="p">()])</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">]</span>
        <span class="n">nexp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span>
        <span class="n">yrange</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nexp</span><span class="p">))</span>
        
        <span class="c1"># Format axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format_axis</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">nexp</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yrange</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
                    
        <span class="c1"># Set expert lines</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">items</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">assessments</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span>
        
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">quantile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">quantiles</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">selected</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">assessments</span><span class="p">[</span><span class="n">selected</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="n">quantile</span><span class="p">]</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">values</span><span class="p">,</span> <span class="n">yrange</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="n">quantile</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="n">quantile</span><span class="p">]</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">([[],</span> <span class="p">[]])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="n">quantile</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">([])</span>

        <span class="c1"># self.figure.tight_layout()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>
            
            
<div class="viewcode-block" id="PlotDistributionsDialog.update_item_plot"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.update_item_plot">[docs]</a>    <span class="k">def</span> <span class="nf">update_item_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to update the item plot after changes are made to the data selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_title</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">==</span> <span class="s1">&#39;cdf&#39;</span><span class="p">:</span>
            <span class="c1"># Get item data</span>
            <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">assessments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_item_data</span><span class="p">(</span><span class="n">full_dm_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
            <span class="c1"># Set expert lines</span>
            <span class="n">quants</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">quantiles</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">expert</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">assessments</span><span class="p">[</span><span class="n">expert</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">expert</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">lower</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">upper</span><span class="p">],</span> <span class="n">quants</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">T</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">expert</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">lower</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">upper</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>

            <span class="c1"># Format axis</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">format_axis</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_data_visible</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">==</span> <span class="s1">&#39;exc prob&#39;</span><span class="p">:</span>
            <span class="c1"># Get item data</span>
            <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">assessments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_item_data</span><span class="p">(</span><span class="n">full_dm_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
            <span class="c1"># Set expert lines</span>
            <span class="n">quants</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">quantiles</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">expert</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">assessments</span><span class="p">[</span><span class="n">expert</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">expert</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">lower</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">upper</span><span class="p">],</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">quants</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">T</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">expert</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">lower</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">upper</span><span class="p">],</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>

            <span class="c1"># Format axis</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">format_axis</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_data_visible</span><span class="p">()</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">==</span> <span class="s1">&#39;pdf&#39;</span><span class="p">:</span>
            <span class="c1"># Get item data</span>
            <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">assessments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_item_data</span><span class="p">(</span><span class="n">full_dm_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Set expert lines</span>
            <span class="n">maxdensity</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">expert</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">assessments</span><span class="p">[</span><span class="n">expert</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">binedges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">lower</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">upper</span><span class="p">]</span>
                    <span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">binedges</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">pdensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">binprobs</span> <span class="o">/</span> <span class="p">(</span><span class="n">binedges</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">binedges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">pdensity</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">binedges</span><span class="p">,</span> <span class="n">binprobs</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">T</span>
                    <span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">binedges</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">binprobs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">binprobs</span><span class="p">)</span>
                    <span class="n">pdensity</span> <span class="o">=</span> <span class="n">binprobs</span> <span class="o">/</span> <span class="p">(</span><span class="n">binedges</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">binedges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">pdensity</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">expert</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
                <span class="n">maxdensity</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">maxdensity</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">pdensity</span><span class="p">))</span>

            <span class="c1"># Format axis</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">format_axis</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">maxdensity</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_data_visible</span><span class="p">()</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">==</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span>
            <span class="c1"># Get item data</span>
            <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">assessments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_item_data</span><span class="p">(</span><span class="n">full_dm_cdf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    
            <span class="n">selected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">idx</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">selectedIndexes</span><span class="p">()])</span>
            <span class="n">experts</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">]</span>
            <span class="n">nexp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span>
            <span class="n">yrange</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nexp</span><span class="p">))</span>

            <span class="c1"># Format axis</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">format_axis</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">nexp</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yrange</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">experts</span><span class="p">)</span>
                        
            <span class="c1"># Set expert lines</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">expert</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">experts</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">expert</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">assessments</span><span class="p">[</span><span class="n">expert</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span>
            
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">exp</span><span class="p">]</span> <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">experts</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">quantile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">quantiles</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">selected</span><span class="p">):</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">assessments</span><span class="p">[</span><span class="n">exp</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">experts</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="n">quantile</span><span class="p">]</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">values</span><span class="p">,</span> <span class="n">yrange</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="n">quantile</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="n">quantile</span><span class="p">]</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">([[],</span> <span class="p">[]])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="n">quantile</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">([])</span>
            
        <span class="c1"># Realization</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_realization</span><span class="p">()</span>

        <span class="c1"># Draw</span>
        <span class="c1"># self.figure.tight_layout()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="PlotDistributionsDialog.update_realization"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.update_realization">[docs]</a>    <span class="k">def</span> <span class="nf">update_realization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set realization as line in plot.</span>
<span class="sd">        If target question, hide the line</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set realization</span>
        <span class="n">itemid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">realizations</span><span class="p">[</span><span class="n">itemid</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="s1">&#39;realization&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="s1">&#39;realization&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">([</span><span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="s1">&#39;realization&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotDistributionsDialog.get_item_data"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.get_item_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_item_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_dm_cdf</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all the data to plot for a certain item</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get item id</span>
        <span class="n">itemid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        
        <span class="c1"># Get expert assessments and bounds for question</span>
        <span class="n">assessments</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">decision_makers</span> <span class="ow">and</span> <span class="n">full_dm_cdf</span><span class="p">:</span>
                <span class="n">assessments</span><span class="p">[</span><span class="n">exp</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">full_cdf</span><span class="p">[</span><span class="n">exp</span><span class="p">][</span><span class="n">itemid</span><span class="p">]</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="n">assessments</span><span class="p">[</span><span class="n">exp</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="n">itemid</span><span class="p">]</span>
            
        <span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">lower_k</span><span class="p">[</span><span class="n">itemid</span><span class="p">]</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">upper_k</span><span class="p">[</span><span class="n">itemid</span><span class="p">]</span>

        <span class="c1"># Convert bounds form log scale to uniform scale in case of log background</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">scale</span><span class="p">[</span><span class="n">itemid</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">assessments</span></div>

<div class="viewcode-block" id="PlotDistributionsDialog.get_expert_data"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.get_expert_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_expert_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all the data to plot for a certain expert</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get item id</span>
        <span class="n">expertid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        
        <span class="c1"># Get expert assessments and bounds (no overshoot) for question</span>
        <span class="n">assessments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="n">expertid</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">lower</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">upper</span>

        <span class="c1"># Convert bounds form log scale to uniform scale in case of log background</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">scale</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">scale</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">scale</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
                <span class="n">lower</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">upper</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="c1"># Normalize data</span>
        <span class="n">assessments</span> <span class="o">=</span> <span class="p">(</span><span class="n">assessments</span> <span class="o">-</span> <span class="n">lower</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">assessments</span></div>

<div class="viewcode-block" id="PlotDistributionsDialog.format_axis"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.format_axis">[docs]</a>    <span class="k">def</span> <span class="nf">format_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set axis limits, called after a plot has been changed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get item id</span>
        <span class="n">itemid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>

        <span class="c1"># Set x axis scale</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">scale</span><span class="p">[</span><span class="n">itemid</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
            <span class="c1"># self.ax.set_xscale(&#39;log&#39;)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

        <span class="c1"># Set limits</span>
        <span class="c1"># self.ax.axis((xmin, xmax, ymin, ymax))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotDistributionsDialog.set_title"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.PlotDistributionsDialog.set_title">[docs]</a>    <span class="k">def</span> <span class="nf">set_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set axis title, called after a plot has been changed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span>
            <span class="c1"># Get item id</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
            <span class="c1"># Add to label</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">questions</span><span class="p">[</span><span class="n">itemid</span><span class="p">])</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;expert&#39;</span><span class="p">:</span>
            <span class="c1"># Get expert id</span>
            <span class="n">expertid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_cbox</span><span class="o">.</span><span class="n">combobox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
            <span class="c1"># Add to label</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="n">expertid</span><span class="p">])</span></div>

    <span class="k">def</span> <span class="nf">_set_data_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to hide or show lines based on the selection in the legend table</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">selectedIndexes</span><span class="p">()]</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">expert</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">expert</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotby</span> <span class="o">==</span> <span class="s1">&#39;expert&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">ids</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">)</span>
        
        <span class="c1"># In case of a range plot, not only toggle visibility, but</span>
        <span class="c1"># also remove re-plot to remove &#39;invisible&#39; items</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">==</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span></div>


<div class="viewcode-block" id="ItemWeightDialog"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ItemWeightDialog">[docs]</a><span class="k">class</span> <span class="nc">ItemWeightDialog</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog to get parameters for calculating decision maker</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ItemWeightDialog</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">results</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Information score per item&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowCloseButtonHint</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>

        <span class="c1"># Add checkbox for colors</span>
        <span class="n">hlayout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hlayout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        <span class="n">hlayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Colormap:&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colorbutton</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colorbutton</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colorbutton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_color</span><span class="p">)</span>
        <span class="n">hlayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colorbutton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hlayout</span><span class="p">)</span>

        <span class="c1"># Create the table view</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableView</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setShowGrid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setAlternatingRowColors</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Create and add model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">info_per_var</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">ArrayModel</span><span class="p">(</span>
            <span class="n">array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">ids</span><span class="p">],</span>
            <span class="n">coldim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">rowdim</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">index_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Expert&#39;</span><span class="p">],</span>
            <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">colorpicker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colorpicker</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setMinimumSectionSize</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setSectionResizeMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHeaderView</span><span class="o">.</span><span class="n">Stretch</span><span class="p">)</span>


        <span class="c1"># Add close button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">HLine</span><span class="p">())</span>

        <span class="c1"># OK and Cancel buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Close&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>

        <span class="n">button_box</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">button_box</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">RejectRole</span><span class="p">)</span>
        <span class="n">button_box</span><span class="o">.</span><span class="n">accepted</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialog</span><span class="o">.</span><span class="n">accept</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button_box</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">experts</span><span class="o">.</span><span class="n">ids</span><span class="p">),</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">600</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">arrmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;RdYlGn&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="ItemWeightDialog.colorpicker"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ItemWeightDialog.colorpicker">[docs]</a>    <span class="k">def</span> <span class="nf">colorpicker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a color for assigning to the cell</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">((</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arrmax</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrmin</span><span class="p">))</span></div>

<div class="viewcode-block" id="ItemWeightDialog.set_color"><a class="viewcode-back" href="../../../ui/results.html#anduryl.ui.results.ItemWeightDialog.set_color">[docs]</a>    <span class="k">def</span> <span class="nf">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changed the table settings after colors are toggled on or off</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">on</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colorbutton</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">layoutAboutToBeChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">colored</span> <span class="o">=</span> <span class="n">on</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setShowGrid</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setAlternatingRowColors</span><span class="p">(</span><span class="ow">not</span> <span class="n">on</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">layoutChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Guus Rongen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>